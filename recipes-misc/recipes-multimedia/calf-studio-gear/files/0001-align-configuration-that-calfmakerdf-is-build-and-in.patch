From fa4ca610a210ccc2029ba1300cce846c92aaa6b5 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andreas=20M=C3=BCller?= <schnitzeltony@googlemail.com>
Date: Sun, 8 Jan 2017 20:36:48 +0100
Subject: [PATCH] align configuration that calfmakerdf is build and installed
 for native
 
we need to pin LV2(GUI) support
 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Andreas MÃ¼ller <schnitzeltony@googlemail.com>
---
 configure.ac    | 80 ---------------------------------------------------------
 src/Makefile.am |  2 +-
 src/makerdf.cpp |  3 +++
 3 files changed, 4 insertion(+), 81 deletions(-)

diff --git a/configure.ac b/configure.ac
index ec9aa6d..bbb2def 100644
--- a/configure.ac
+++ b/configure.ac
@@ -53,90 +53,10 @@ AC_CHECK_HEADERS([memory.h stdint.h stdlib.h string.h time.h math.h])
 AC_CHECK_HEADER(expat.h, true, AC_MSG_ERROR([Expat XML library not found]))
 AC_CHECK_LIB(expat, XML_Parse, true, AC_MSG_ERROR([Expat XML library not found]))
 
-# JACK
-AC_CHECK_HEADERS([jack/jack.h], have_jack_header=yes, have_jack_header=no)
-
 # GLib
 PKG_CHECK_MODULES(GLIB_DEPS, glib-2.0 >= 2.0.0 gthread-2.0 >= 2.0.0, true, AC_MSG_ERROR([Calf requires glib2 and gthread2]))
 
-# Fluidsynth
-PKG_CHECK_MODULES(FLUIDSYNTH_DEPS, fluidsynth >= 1.0.7, true, AC_MSG_ERROR([fluidsynth library not found]))
-
-# Sordi
-AC_CHECK_PROG(SORDI_ENABLED, sordi, yes, no)
-
-if test "$have_jack_header" = "yes"; then
-  PKG_CHECK_MODULES(JACK_DEPS, jack >= 0.103.0,
-    AC_CHECK_LIB([jack], [jack_port_register], JACK_FOUND="yes", ),)
-fi
-
-if test "$JACK_FOUND" = "yes"; then
-  PKG_CHECK_MODULES(JACK_MIDI_DEPS, jack >= 0.105.0, OLD_JACK="no", OLD_JACK="yes")
-fi
-
-PKG_CHECK_MODULES(LV2_DEPS, lv2core >= 6, LV2_FOUND="yes", LV2_FOUND="no")
-
-PKG_CHECK_MODULES(LASH_DEPS, lash-1.0 >= 0.6.0,
-  AC_CHECK_LIB([lash], [lash_client_is_being_restored], LASH_0_6_FOUND="yes", LASH_0_6_FOUND="no"),
-  LASH_0_6_FOUND="no")
-if test "$LASH_0_6_FOUND" = "yes"; then
-  LASH_FOUND="yes"
-else
-  PKG_CHECK_MODULES(LASH_DEPS, lash-1.0 >= 0.5.2, LASH_FOUND="yes", LASH_FOUND="no")
-fi
-PKG_CHECK_MODULES(SLV2_HACK, slv2 <= 0.6.1, SLV2_UNSUPPORTED="yes", SLV2_UNSUPPORTED="no")
-
-############################################################################################
-# Assign initial values to feature control variables
-
-LV2_ENABLED=$LV2_FOUND
-LASH_ENABLED=$LASH_FOUND
-
-if test "$JACK_FOUND" = "yes" -o "$LV2_FOUND" = "yes"; then
-  PKG_CHECK_MODULES(GUI_DEPS, gtk+-2.0 >= 2.12.0 cairo >= 1.2.0,
-    GUI_ENABLED="yes",
-    GUI_ENABLED="no (GTK+ 2.12 and cairo 1.2 or newer required)"
-  )
-fi
-
-############################################################################################
-# Look for settings and installed libraries to determine what to compile/install/use
-if test "$LV2_FOUND" = "yes"; then
-  AC_MSG_CHECKING([whether to allow LV2])
-  AC_ARG_WITH(lv2,
-    AC_HELP_STRING([--without-lv2],[disable LV2 interface]),
-      [if test "$withval" = "no"; then LV2_ENABLED="no"; fi],[])
-  AC_MSG_RESULT($LV2_ENABLED)
-fi
-
-if test "$LASH_FOUND" = "yes"; then
-  AC_MSG_CHECKING([whether to allow LASH])
-  AC_ARG_WITH(lash,
-    AC_HELP_STRING([--without-lash],[disable LASH compatibility (GPL)]),
-      [if test "$withval" = "no"; then LASH_ENABLED="no"; fi],[])
-  AC_MSG_RESULT($LASH_ENABLED)
-fi
 
-AC_MSG_CHECKING([whether to enable experimental/unfinished features])
-AC_ARG_ENABLE(experimental,
-  AC_HELP_STRING([--enable-experimental],[enable unfinished features - not recommended!]),
-  [set_enable_experimental="$enableval"],
-  [set_enable_experimental="no"])
-AC_MSG_RESULT($set_enable_experimental)
-
-AC_MSG_CHECKING([whether to enable debugging mode])
-AC_ARG_ENABLE(debug,
-  AC_HELP_STRING([--enable-debug],[enable debug mode - slow!]),
-  [set_enable_debug="$enableval"],
-  [set_enable_debug="no"])
-AC_MSG_RESULT($set_enable_debug)
-
-AC_MSG_CHECKING([whether to compile with SSE])
-AC_ARG_ENABLE(sse,
-  AC_HELP_STRING([--enable-sse],[compile with SSE extensions]),
-  [set_enable_sse="$enableval"],
-  [set_enable_sse="no"])
-AC_MSG_RESULT($set_enable_sse)
 
 ############################################################################################
 # Compute status shell variables
diff --git a/src/Makefile.am b/src/Makefile.am
index 794e668..dad8f89 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -30,7 +30,7 @@ endif
 endif
 
 AM_CXXFLAGS += $(GLIB_DEPS_CFLAGS)
-noinst_PROGRAMS += calfmakerdf
+bin_PROGRAMS += calfmakerdf
 calfmakerdf_SOURCES = makerdf.cpp
 calfmakerdf_LDADD = calf.la
 
diff --git a/src/makerdf.cpp b/src/makerdf.cpp
index ddc6318..4e3284d 100644
--- a/src/makerdf.cpp
+++ b/src/makerdf.cpp
@@ -21,6 +21,8 @@
 #include <calf/giface.h>
 #include <calf/preset.h>
 #include <calf/utils.h>
+#define USE_LV2 1
+#define USE_LV2_GUI 1
 #if USE_LV2
 #include <lv2.h>
 #include <calf/lv2_atom.h>
-- 
2.5.5

