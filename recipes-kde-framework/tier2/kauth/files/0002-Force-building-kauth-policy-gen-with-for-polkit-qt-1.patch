From a6bf4b1f4596194f5ba45c5af8680e703729a256 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andreas=20M=C3=BCller?= <schnitzeltony@googlemail.com>
Date: Tue, 9 Dec 2014 07:49:18 +0100
Subject: [PATCH 2/3] Force building kauth-policy-gen with for polkit-qt-1
 backend
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

we need that for native build

Upstream-Status: Inappropriate [embedded specific]

Signed-off-by: Andreas MÃ¼ller <schnitzeltony@googlemail.com>
---
 src/CMakeLists.txt        | 14 ++++++--------
 src/ConfigureChecks.cmake | 17 ++++-------------
 2 files changed, 10 insertions(+), 21 deletions(-)

diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index 946d042..0f9b8c7 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -52,16 +52,14 @@ ecm_generate_headers(KAuth_HEADERS
 
 # Compile only if fake backend has not been selected
 
-if (NOT "${KAUTH_BACKEND_NAME}" STREQUAL "FAKE")
-    # KAUTH_POLICY_GEN_SRCS has been generated from ConfigureChecks.cmake
-    add_executable(kauth-policy-gen ${KAUTH_POLICY_GEN_SRCS})
-    add_executable(KF5::kauth-policy-gen ALIAS kauth-policy-gen)
+# KAUTH_POLICY_GEN_SRCS has been generated from ConfigureChecks.cmake
+add_executable(kauth-policy-gen ${KAUTH_POLICY_GEN_SRCS})
+add_executable(KF5::kauth-policy-gen ALIAS kauth-policy-gen)
 
-    # KAUTH_POLICY_GEN_LIBRARIES has been generated from ConfigureChecks.cmake
-    target_link_libraries( kauth-policy-gen PRIVATE ${KAUTH_POLICY_GEN_LIBRARIES} )
+# KAUTH_POLICY_GEN_LIBRARIES has been generated from ConfigureChecks.cmake
+target_link_libraries( kauth-policy-gen PRIVATE ${KAUTH_POLICY_GEN_LIBRARIES} )
 
-    install( TARGETS kauth-policy-gen EXPORT KF5AuthTargets DESTINATION ${KAUTH_HELPER_INSTALL_DIR})
-endif ()
+install( TARGETS kauth-policy-gen EXPORT KF5AuthTargets DESTINATION ${KAUTH_HELPER_INSTALL_DIR})
 
 # KAuth backend plugin
 
diff --git a/src/ConfigureChecks.cmake b/src/ConfigureChecks.cmake
index d46761a..48f33a2 100644
--- a/src/ConfigureChecks.cmake
+++ b/src/ConfigureChecks.cmake
@@ -169,19 +169,10 @@ set(KAUTH_POLICY_GEN_SRCS
     policy-gen/policy-gen.cpp )
 set(KAUTH_POLICY_GEN_LIBRARIES)
 
-if(KAUTH_BACKEND_NAME STREQUAL "OSX")
-   set(KAUTH_POLICY_GEN_SRCS ${KAUTH_POLICY_GEN_SRCS}
-       backends/mac/kauth-policy-gen-mac.cpp)
-   set(KAUTH_POLICY_GEN_LIBRARIES ${KAUTH_POLICY_GEN_LIBRARIES} ${CORE_FOUNDATION_LIBRARY} ${SECURITY_LIBRARY} Qt5::Core)
-elseif(KAUTH_BACKEND_NAME STREQUAL "POLKITQT")
-   set(KAUTH_POLICY_GEN_SRCS ${KAUTH_POLICY_GEN_SRCS}
-       backends/policykit/kauth-policy-gen-polkit.cpp )
-elseif(KAUTH_BACKEND_NAME STREQUAL "POLKITQT5-1")
-  set(KAUTH_POLICY_GEN_SRCS ${KAUTH_POLICY_GEN_SRCS}
-      backends/polkit-1/kauth-policy-gen-polkit1.cpp )
-  set(KAUTH_POLICY_GEN_LIBRARIES ${KAUTH_POLICY_GEN_LIBRARIES}
-      Qt5::Core)
-endif()
+set(KAUTH_POLICY_GEN_SRCS ${KAUTH_POLICY_GEN_SRCS}
+    backends/polkit-1/kauth-policy-gen-polkit1.cpp )
+set(KAUTH_POLICY_GEN_LIBRARIES ${KAUTH_POLICY_GEN_LIBRARIES}
+    Qt5::Core)
 
 ########################
 # Helper backend probing
-- 
1.8.3.1

