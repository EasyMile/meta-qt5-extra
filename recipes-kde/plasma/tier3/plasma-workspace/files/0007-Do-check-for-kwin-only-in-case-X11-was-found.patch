From 5133618013e0806e709a123e1f3bc20c8e51afc5 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andreas=20M=C3=BCller?= <schnitzeltony@googlemail.com>
Date: Thu, 11 Dec 2014 13:37:36 +0100
Subject: [PATCH 02/12] Do check for kwin only in case X11 was found
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Andreas MÃ¼ller <schnitzeltony@googlemail.com>
---
 CMakeLists.txt | 49 +++++++++++++++++++++++++++----------------------
 1 file changed, 27 insertions(+), 22 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index c7da3e7..7cb7522 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -23,8 +23,7 @@ find_package(KF5 5.0.93 REQUIRED COMPONENTS Screen)
 # Baloo has a different version scheme than KF5 for now
 find_package(KF5 5.1 REQUIRED COMPONENTS Baloo)
 find_package(KF5TextEditor)
-find_package(KWinDBusInterface CONFIG REQUIRED)
-find_package(KF5WebKit)
+
 
 include(KDEInstallDirs)
 include(KDECMakeSettings)
@@ -36,6 +35,32 @@ include(WriteBasicConfigVersionFile)
 include(CheckIncludeFiles)
 include(FeatureSummary)
 
+find_package(X11)
+set_package_properties(X11 PROPERTIES DESCRIPTION "X11 libraries"
+                       URL "http://www.x.org"
+                       TYPE OPTIONAL
+                       PURPOSE "Required for building the X11 based workspace")
+
+if(X11_FOUND)
+  find_package(XCB MODULE REQUIRED COMPONENTS XCB KEYSYMS)
+  set_package_properties(XCB PROPERTIES TYPE REQUIRED)
+  if(NOT X11_SM_FOUND)
+    message(FATAL_ERROR "\nThe X11 Session Management (SM) development package could not be found.\nPlease install libSM.\n")
+  endif(NOT X11_SM_FOUND)
+
+  find_package(Qt5 ${QT_MIN_VERSION} CONFIG REQUIRED COMPONENTS X11Extras)
+endif()
+
+if(X11_FOUND AND XCB_XCB_FOUND)
+  set(HAVE_X11 1)
+endif()
+
+if(HAVE_X11)
+    find_package(KWinDBusInterface CONFIG REQUIRED)
+endif()
+
+find_package(KF5WebKit)
+
 find_package(Qt5WebKitWidgets ${QT_MIN_VERSION} CONFIG)
 
 set_package_properties(Qt5WebKitWidgets PROPERTIES
@@ -64,26 +89,6 @@ set_package_properties(dbusmenu-qt5 PROPERTIES DESCRIPTION "Support for notifica
                        TYPE OPTIONAL
                       )
 
-find_package(X11)
-set_package_properties(X11 PROPERTIES DESCRIPTION "X11 libraries"
-                       URL "http://www.x.org"
-                       TYPE OPTIONAL
-                       PURPOSE "Required for building the X11 based workspace")
-
-if(X11_FOUND)
-  find_package(XCB MODULE REQUIRED COMPONENTS XCB KEYSYMS)
-  set_package_properties(XCB PROPERTIES TYPE REQUIRED)
-  if(NOT X11_SM_FOUND)
-    message(FATAL_ERROR "\nThe X11 Session Management (SM) development package could not be found.\nPlease install libSM.\n")
-  endif(NOT X11_SM_FOUND)
-
-  find_package(Qt5 ${QT_MIN_VERSION} CONFIG REQUIRED COMPONENTS X11Extras)
-endif()
-
-if(X11_FOUND AND XCB_XCB_FOUND)
-  set(HAVE_X11 1)
-endif()
-
 find_package(KF5Wayland CONFIG)
 set_package_properties(KF5Wayland PROPERTIES
                        TYPE REQUIRED
-- 
1.8.3.1
